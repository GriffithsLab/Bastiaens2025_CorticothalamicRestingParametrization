# The preprocessing MNE-BIDS pipeline is an adaptation of the configuration file by Engemann et al. provided at the following link: https://github.com/meeg-ml-benchmarks/brain-age-benchmark-paper called config_camcan_meg.py as we used Cam-CAN maxfiltered data

# Source paper: D. Engemann, A. Mellot, R. HÃ¶chenberger, H. Banville, D. Sabbagh, L. Gemein, T. Ball, and A. Gramfort. A reusable benchmark of brain-age prediction from M/EEG resting-state signals (2022). NeuroImage 262 (119521): 119521.  from the config_camcan_meg.py file in the github folder

import pathlib
import mne
import os
study_name = "resting-state-age"


bids_root = pathlib.Path(
'/path_to_mf_camcan_data/all_camcan_meg_rest_mf_copy/')

deriv_root = pathlib.Path('/path_to_save_outputs/new_derivatives')

subjects_dir = pathlib.Path('/path_to_freesurfer/freesurfer_subjects')
os.environ['SUBJECTS_DIR'] = '/path_to_freesurfer/freesurfer_subjects'


# Note: The filterbank source model requires on the Cam-Can dataset a reduced size template head model. 
#After setting your FreeSurfer subjects_dir you can obtain the scaled MRI called fsaverage_small using:
#mne.coreg.scale_mri("fsaverage", "fsaverage_small", scale=0.9, subjects_dir=subjects_dir, annot=True, overwrite=True)

source_info_path_update = {'processing': 'clean',#'autoreject',
                           'suffix': 'epo'}
inverse_targets = []

noise_cov = 'ad-hoc'

task = 'rest'
task_is_rest = True
sessions = ['rest']  
data_type = 'meg'
ch_types = ['meg']

# mag channels
analyze_channels = [
    'MEG0111', 'MEG0121', 'MEG0131', 'MEG0141', 'MEG0211',
    'MEG0221', 'MEG0231', 'MEG0241', 'MEG0311', 'MEG0321', 'MEG0331',
    'MEG0341', 'MEG0411', 'MEG0421', 'MEG0431', 'MEG0441', 'MEG0511',
    'MEG0521', 'MEG0531', 'MEG0541', 'MEG0611', 'MEG0621', 'MEG0631',
    'MEG0641', 'MEG0711', 'MEG0721', 'MEG0731', 'MEG0741', 'MEG0811',
    'MEG0821', 'MEG0911', 'MEG0921', 'MEG0931', 'MEG0941', 'MEG1011',
    'MEG1021', 'MEG1031', 'MEG1041', 'MEG1111', 'MEG1121', 'MEG1131',
    'MEG1141', 'MEG1211', 'MEG1221', 'MEG1231', 'MEG1241', 'MEG1311',
    'MEG1321', 'MEG1331', 'MEG1341', 'MEG1411', 'MEG1421', 'MEG1431',
    'MEG1441', 'MEG1511', 'MEG1521', 'MEG1531', 'MEG1541', 'MEG1611',
    'MEG1621', 'MEG1631', 'MEG1641', 'MEG1711', 'MEG1721', 'MEG1731',
    'MEG1741', 'MEG1811', 'MEG1821', 'MEG1831', 'MEG1841', 'MEG1911',
    'MEG1921', 'MEG1931', 'MEG1941', 'MEG2011', 'MEG2021', 'MEG2031',
    'MEG2041', 'MEG2111', 'MEG2121', 'MEG2131', 'MEG2141', 'MEG2211',
    'MEG2221', 'MEG2231', 'MEG2241', 'MEG2311', 'MEG2321', 'MEG2331',
    'MEG2341', 'MEG2411', 'MEG2421', 'MEG2431', 'MEG2441', 'MEG2511',
    'MEG2521', 'MEG2531', 'MEG2541', 'MEG2611', 'MEG2621', 'MEG2631',
    'MEG2641'
]

l_freq = 0.1
h_freq = 49

eeg_reference = []

eog_channels = []

find_breaks = False

n_proj_eog = 1

reject = None

on_rename_missing_events = "warn"

n_jobs=10
epochs_decim = 5  # Cam-CAN has 1000 Hz; 

epochs_tmin = 0.
epochs_tmax = 10.
rest_epochs_overlap = 0.
rest_epochs_duration = 10.
baseline = None

run_source_estimation = True
use_template_mri = "fsaverage_small" 
adjust_coreg = True

event_repeated = "drop"
l_trans_bandwidth = "auto"

h_trans_bandwidth = "auto"

random_state = 42

shortest_event = 1

log_level = "info"

mne_log_level = "error"

# on_error = 'continue'
on_error = "continue"

#n_jobs = 40
n_jobs=10
subjects = ['CC420226',
 'CC220323',
 'CC720670',
 'CC520209',
 'CC721377',
 'CC420241',
 'CC321529',
 'CC610039',
 'CC310160',
 'CC721648',
 'CC722077',
 'CC120184',
 'CC723395',
 'CC610308',
 'CC420392',
 'CC120061',
 'CC321069',
 'CC721374',
 'CC720646',
 'CC520503',
 'CC222264',
 'CC320576',
 'CC120470',
 'CC420143',
 'CC520254',
 'CC710223',
 'CC321137',
 'CC410113',
 'CC620193',
 'CC610210',
 'CC510434',
 'CC320379',
 'CC121795',
 'CC420180',
 'CC320616',
 'CC220920',
 'CC510115',
 'CC620121',
 'CC210051',
 'CC620114',
 'CC420229',
 'CC520390',
 'CC320321',
 'CC520279',
 'CC310214',
 'CC210023',
 'CC420244',
 'CC121685',
 'CC121144',
 'CC521040',
 'CC410173',
 'CC721107',
 'CC620314',
 'CC620526',
 'CC620490',
 'CC321203',
 'CC220198',
 'CC320870',
 'CC410387',
 'CC321976',
 'CC320107',
 'CC321431',
 'CC520011',
 'CC420149',
 'CC610625',
 'CC420167',
 'CC620164',
 'CC420454',
 'CC620527',
 'CC110037',
 'CC321174',
 'CC621199',
 'CC520078',
 'CC510486',
 'CC410323',
 'CC420091',
 'CC721434',
 'CC221740',
 'CC321025',
 'CC720304',
 'CC220511',
 'CC110174',
 'CC320448',
 'CC221244',
 'CC120008',
 'CC710429',
 'CC220535',
 'CC510259',
 'CC710037',
 'CC210174',
 'CC321053',
 'CC320888',
 'CC321557',
 'CC510161',
 'CC620152',
 'CC620515',
 'CC320553',
 'CC320861',
 'CC220828',
 'CC310331',
 'CC120313',
 'CC520239',
 'CC610292',
 'CC721729',
 'CC420435',
 'CC220115',
 'CC510321',
 'CC420137',
 'CC420100',
 'CC210617',
 'CC610076',
 'CC710446',
 'CC620619',
 'CC621284',
 'CC320336',
 'CC510355',
 'CC710664',
 'CC722542',
 'CC110187',
 'CC320267',
 'CC321504',
 'CC220419',
 'CC510648',
 'CC510237',
 'CC420071',
 'CC220901',
 'CC610508',
 'CC310008',
 'CC420075',
 'CC520168',
 'CC420173',
 'CC120065',
 'CC720071',
 'CC520552',
 'CC510050',
 'CC321281',
 'CC420094',
 'CC321087',
 'CC410243',
 'CC610568',
 'CC722651',
 'CC721392',
 'CC410222',
 'CC510220',
 'CC420060',
 'CC310142',
 'CC720941',
 'CC610372',
 'CC520436',
 'CC310361',
 'CC221511',
 'CC610212',
 'CC420217',
 'CC321899',
 'CC220372',
 'CC620821',
 'CC310252',
 'CC410226',
 'CC210088',
 'CC221220',
 'CC610028',
 'CC320206',
 'CC310410',
 'CC520253',
 'CC410220',
 'CC221054',
 'CC110101',
 'CC610146',
 'CC320359',
 'CC410325',
 'CC223286',
 'CC410094',
 'CC720511',
 'CC121428',
 'CC120212',
 'CC210124',
 'CC610058',
 'CC620454',
 'CC221209',
 'CC220203',
 'CC720290',
 'CC220132',
 'CC120049',
 'CC510548',
 'CC310400',
 'CC310414',
 'CC410179',
 'CC420148',
 'CC620793',
 'CC121200',
 'CC220519',
 'CC321544',
 'CC120120',
 'CC520517',
 'CC710566',
 'CC320651',
 'CC620405',
 'CC110056',
 'CC222185',
 'CC520480',
 'CC520980',
 'CC520147',
 'CC710382',
 'CC520042',
 'CC420061',
 'CC310463',
 'CC420582',
 'CC712027',
 'CC520122',
 'CC410129',
 'CC720516',
 'CC220610',
 'CC120469',
 'CC320109',
 'CC510284',
 'CC620118',
 'CC710154',
 'CC620549',
 'CC711027',
 'CC610071',
 'CC410287',
 'CC223115',
 'CC520215',
 'CC310086',
 'CC620279',
 'CC410169',
 'CC410040',
 'CC320893',
 'CC310203',
 'CC222555',
 'CC120795',
 'CC320059',
 'CC620354',
 'CC210172',
 'CC223085',
 'CC520560',
 'CC221040',
 'CC320160',
 'CC420236',
 'CC720723',
 'CC711158',
 'CC120218',
 'CC420433',
 'CC520065',
 'CC320202',
 'CC222496',
 'CC510395',
 'CC222652',
 'CC221565',
 'CC420493',
 'CC120376',
 'CC410354',
 'CC120347',
 'CC711128',
 'CC610285',
 'CC420412',
 'CC210526',
 'CC320759',
 'CC710462',
 'CC221648',
 'CC610227',
 'CC621080',
 'CC710350',
 'CC520398',
 'CC720986',
 'CC720358',
 'CC610022',
 'CC520287',
 'CC610061',
 'CC110033',
 'CC220843',
 'CC310129',
 'CC520136',
 'CC520424',
 'CC120309',
 'CC320574',
 'CC310385',
 'CC220107',
 'CC520013',
 'CC610496',
 'CC620359',
 'CC221980',
 'CC621248',
 'CC410432',
 'CC510076',
 'CC620610',
 'CC120264',
 'CC221107',
 'CC620259',
 'CC510474',
 'CC321506',
 'CC520673',
 'CC520211',
 'CC220223',
 'CC520624',
 'CC610392',
 'CC221775',
 'CC320621',
 'CC220151',
 'CC220234',
 'CC222120',
 'CC710486',
 'CC320218',
 'CC420396',
 'CC120137',
 'CC320568',
 'CC721894',
 'CC420204',
 'CC520745',
 'CC520607',
 'CC320325',
 'CC420464',
 'CC310052',
 'CC320686',
 'CC220697',
 'CC220635',
 'CC510415',
 'CC120764',
 'CC520134',
 'CC721704',
 'CC510629',
 'CC110126',
 'CC110098',
 'CC510342',
 'CC610658',
 'CC221954',
 'CC220352',
 'CC320680',
 'CC420888',
 'CC610052',
 'CC310450',
 'CC222258',
 'CC221352',
 'CC220506',
 'CC410086',
 'CC510329',
 'CC620005',
 'CC210519',
 'CC321368',
 'CC510304',
 'CC120409',
 'CC321880',
 'CC620466',
 'CC510639',
 'CC320297',
 'CC722421',
 'CC320361',
 'CC210250',
 'CC510480',
 'CC410032',
 'CC510043',
 'CC412021',
 'CC222326',
 'CC510438',
 'CC610178',
 'CC710591',
 'CC510433',
 'CC510473',
 'CC320022',
 'CC510258',
 'CC420157',
 'CC620499',
 'CC420198',
 'CC510609',
 'CC420587',
 'CC120462',
 'CC221031',
 'CC221585',
 'CC222125',
 'CC120182',
 'CC410248',
 'CC510163',
 'CC110087',
 'CC310391',
 'CC310473',
 'CC610575',
 'CC420566',
 'CC620090',
 'CC122405',
 'CC220335',
 'CC510534',
 'CC510208',
 'CC520868',
 'CC710551',
 'CC620557',
 'CC221373',
 'CC620413',
 'CC620496',
 'CC720774',
 'CC520597',
 'CC721888',
 'CC321073',
 'CC620885',
 'CC220713',
 'CC321464',
 'CC110182',
 'CC320088',
 'CC320478',
 'CC520127',
 'CC710494',
 'CC410251',
 'CC610405',
 'CC420383',
 'CC320850',
 'CC720407',
 'CC620436',
 'CC621011',
 'CC510242',
 'CC321154',
 'CC710342',
 'CC620919',
 'CC720329',
 'CC610576',
 'CC420364',
 'CC320461',
 'CC520584',
 'CC321331',
 'CC320636',
 'CC721532',
 'CC721707',
 'CC420222',
 'CC312149',
 'CC721449',
 'CC320500',
 'CC321585',
 'CC220974',
 'CC410289',
 'CC122620',
 'CC410286',
 'CC221527',
 'CC220999',
 'CC320445',
 'CC620720',
 'CC510226',
 'CC221033',
 'CC420202',
 'CC620479',
 'CC510039',
 'CC312058',
 'CC410121',
 'CC510392',
 'CC321428',
 'CC710548',
 'CC221737',
 'CC520775',
 'CC110069',
 'CC310135',
 'CC221886',
 'CC322186',
 'CC220518',
 'CC621184',
 'CC410091',
 'CC610050',
 'CC120550',
 'CC721519',
 'CC420089',
 'CC212153',
 'CC710982',
 'CC610040',
 'CC720119',
 'CC320814',
 'CC610288',
 'CC520097',
 'CC412004',
 'CC120166',
 'CC420462',
 'CC620444',
 'CC222304',
 'CC321595',
 'CC220526',
 'CC320661',
 'CC720497',
 'CC720023',
 'CC420182',
 'CC520002',
 'CC510243',
 'CC420623',
 'CC110606',
 'CC721291',
 'CC520585',
 'CC320575',
 'CC710176',
 'CC721114',
 'CC222367',
 'CC510323',
 'CC610671',
 'CC720103',
 'CC220098',
 'CC520083',
 'CC420720',
 'CC121317',
 'CC610653',
 'CC520247',
 'CC410284',
 'CC420286',
 'CC711035',
 'CC721418',
 'CC520562',
 'CC410015',
 'CC720238',
 'CC221977',
 'CC520053',
 'CC721891',
 'CC210182',
 'CC610631',
 'CC620129',
 'CC520055',
 'CC520477',
 'CC410084',
 'CC710088',
 'CC720685',
 'CC420356',
 'CC121479',
 'CC110319',
 'CC420402',
 'CC320417',
 'CC620592',
 'CC722536',
 'CC121411',
 'CC121397',
 'CC620518',
 'CC721224',
 'CC620284',
 'CC221935',
 'CC320698',
 'CC321291',
 'CC721504',
 'CC320429',
 'CC620264',
 'CC110045',
 'CC221336',
 'CC220284',
 'CC320904',
 'CC120319',
 'CC510483',
 'CC210657',
 'CC420004',
 'CC310051',
 'CC520175',
 'CC420589',
 'CC320002',
 'CC620935',
 'CC710214',
 'CC520377',
 'CC122172',
 'CC120276',
 'CC112141',
 'CC510255',
 'CC620572',
 'CC420324',
 'CC620406',
 'CC620026',
 'CC520395',
 'CC121111',
 'CC420776',
 'CC310224',
 'CC721585',
 'CC510393',
 'CC310397',
 'CC420197',
 'CC321594',
 'CC510354',
 'CC620567',
 'CC722891',
 'CC610101',
 'CC720622',
 'CC610099',
 'CC420260',
 'CC222797',
 'CC121106',
 'CC222956',
 'CC420231',
 'CC610344',
 'CC710131',
 'CC221487',
 'CC120640',
 'CC720188',
 'CC221324',
 'CC121158',
 'CC221002',
 'CC620106',
 'CC621642',
 'CC410119',
 'CC510551',
 'CC221828',
 'CC320089',
 'CC410390',
 'CC610594',
 'CC221755',
 'CC320428',
 'CC310256',
 'CC520391',
 'CC420261',
 'CC320687',
 'CC620262',
 'CC210422',
 'CC620785',
 'CC312222',
 'CC721292',
 'CC620451',
 'CC220567',
 'CC520200',
 'CC510086',
 'CC410297',
 'CC420348',
 'CC410101',
 'CC321107',
 'CC711245',
 'CC320776',
 'CC410177',
 'CC420162',
 'CC720400',
 'CC320608',
 'CC721052',
 'CC110411',
 'CC221595',
 'CC210148',
 'CC710313',
 'CC710679',
 'CC120727',
 'CC621128',
 'CC610046',
 'CC620073',
 'CC321000',
 'CC620659',
 'CC610469',
 'CC420322',
 'CC420729',
 'CC320342',
 'CC620429',
 'CC620085']
